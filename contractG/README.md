# 合同生成工具 (contractG)

![版本](https://img.shields.io/badge/版本-1.1.0-blue)
![Python](https://img.shields.io/badge/Python-3.6+-green)
![许可证](https://img.shields.io/badge/许可证-MIT-orange)

> **一分钟生成专业合同和报价单，让销售工作更高效！**

<p align="center">
  <img src="resources/icon.ico" alt="contractG Logo" width="120">
</p>

## ✨ 核心功能

- **📝 一键生成合同** - 选择客户和商品，自动生成专业销售合同
- **💰 智能报价单** - 自动计算金额，生成美观报价单
- **🔄 Excel转PDF** - 拖放式转换，支持添加公司印章
- **👥 客户管理** - 完整客户信息库，快速检索
- **📦 商品管理** - 灵活的商品目录，价格管理
- **🏢 多公司支持** - 管理多个公司主体，一键切换
- **🎨 精美启动画面** - 现代化设计，提升用户体验

## 🚀 快速开始

1. 双击`启动合同生成工具.bat`
2. 欣赏精美启动画面，等待程序加载完成
3. 配置您的公司信息和印章
4. 添加客户和商品信息
5. 切换到"合同生成"标签页
6. 选择客户、添加商品、设置合同信息
7. 点击"生成合同"按钮
8. 完成！合同和报价单已生成

## 📋 详细功能

<details>
<summary><b>合同生成系统</b> (点击展开)</summary>

- ✅ 自动计算合同金额（含技术服务费）
- ✅ 自定义合同编号、签订日期、交货日期
- ✅ 灵活的付款方式设置
- ✅ 一键转换为PDF并添加公司印章
- ✅ 支持图片式PDF转换，提高兼容性
</details>

<details>
<summary><b>Excel转PDF工具</b> (点击展开)</summary>

- ✅ 拖放式文件转换，操作简单直观
- ✅ 图片式PDF转换选项，确保跨平台兼容性
- ✅ 实时转换进度显示
- ✅ 转换完成后一键打开文件
</details>

<details>
<summary><b>客户与商品管理</b> (点击展开)</summary>

- ✅ 添加、编辑、删除客户和商品信息
- ✅ 完整的客户资料管理（公司名称、联系人、电话、地址、银行账户等）
- ✅ 详细的商品信息记录（名称、规格型号、单位、单价等）
- ✅ 智能搜索与筛选功能
</details>

<details>
<summary><b>公司信息管理</b> (点击展开)</summary>

- ✅ 多公司信息管理，支持切换不同乙方主体
- ✅ 公司印章上传与管理
- ✅ 智能解析导入公司信息
</details>

<details>
<summary><b>用户界面体验</b> (点击展开)</summary>

- ✅ 精美现代化启动画面，展示应用标识和加载进度
- ✅ 响应式界面设计，适应不同屏幕分辨率
- ✅ 直观的标签式导航，快速切换功能模块
- ✅ 统一的视觉风格，提供专业的用户体验
</details>

## 💻 系统要求

- **操作系统**: Windows 7/8/10/11
- **内存**: 最低2GB RAM
- **存储空间**: 至少200MB可用空间

## 📥 安装方法

### 方法一：直接使用（推荐）

1. 下载最新版本
2. 解压到任意目录
3. 双击`启动合同生成工具.bat`

### 方法二：从源代码安装

```bash
# 克隆仓库
git clone https://github.com/yourusername/contractG.git

# 安装依赖
pip install -r requirements.txt

# 运行程序
python src/launcher.py
```

## ❓ 常见问题

<details>
<summary><b>程序无法启动怎么办？</b></summary>
<p>
- 确保系统满足最低配置要求<br>
- 尝试以管理员身份运行程序<br>
- 查看logs目录下的日志文件
</p>
</details>

<details>
<summary><b>如何修改合同模板？</b></summary>
<p>
- 模板文件位于templates目录下<br>
- 直接编辑Excel模板文件，保留所有占位符<br>
- 修改后保存，系统会自动使用新模板
</p>
</details>

<details>
<summary><b>如何备份数据？</b></summary>
<p>
- 复制data目录下的customers.xlsx和products.xlsx文件<br>
- 同时备份config目录下的配置文件
</p>
</details>

## 📝 版本历史

### v1.1.1 (2024-03-18)
- ✨ 新增精美启动画面，提升用户体验
- 🎨 优化应用程序图标显示
- 🔧 改进用户界面视觉效果
- ⚡️ 优化应用程序启动流程

### v1.1.0 (2024-03-15)
- ✨ 新增Excel转PDF工具，支持拖放转换
- ✨ 新增多公司管理功能
- 🔄 优化用户界面和交互体验

### v1.0.0 (2024-03-12)
- 🚀 首次发布，基础合同管理功能

## 🔮 未来计划

1. 📊 **数据分析与报表** - 销售数据统计和可视化
2. 🔄 **合同模板自定义** - 更灵活的模板编辑
3. 📱 **移动端支持** - 远程查看合同
4. 📑 **骑缝章支持** - 多页PDF合同自动添加骑缝章

## 📄 许可证

本项目采用 MIT 许可证。

---

<p align="center">
  <b>合同生成工具 (contractG)</b><br>
  让合同管理更简单、更高效！<br>
  Copyright © 2024 contractG Team
</p>

<details>
<summary><b>完整文档</b> (点击展开)</summary>

## 📑 完整目录

- [功能概览](#-核心功能)
- [快速开始](#-快速开始)
- [详细功能](#-详细功能)
- [系统要求](#-系统要求)
- [安装方法](#-安装方法)
- [常见问题](#-常见问题)
- [版本历史](#-版本历史)
- [未来计划](#-未来计划)
- [许可证](#-许可证)

## 📖 详细使用说明

### 启动程序

1. 双击`启动合同生成工具.bat`
2. 程序启动时会显示精美的启动画面
   - 显示应用程序名称和图标
   - 实时显示加载进度
   - 提示当前加载状态
3. 启动画面完成后，自动进入主界面

### 客户管理

1. 切换到"客户管理"标签页
2. 点击"添加客户"按钮，填写客户信息
   - 公司名称（必填）
   - 联系人
   - 电话
   - 地址
   - 开户银行
   - 银行账号
   - 税号
3. 点击"保存"按钮完成添加
4. 客户列表支持以下操作：
   - 双击客户行：编辑客户信息
   - 选中客户后点击"删除"：删除客户
   - 在搜索框输入关键词：快速查找客户

### 商品管理

1. 切换到"商品管理"标签页
2. 点击"添加商品"按钮，填写商品信息
   - 商品名称（必填）
   - 规格型号
   - 单位
   - 单价（必填）
3. 点击"保存"按钮完成添加
4. 商品列表支持以下操作：
   - 双击商品行：编辑商品信息
   - 选中商品后点击"删除"：删除商品
   - 在搜索框输入关键词：快速查找商品

### 合同生成

1. 切换到"合同生成"标签页
2. 在左侧客户列表中选择客户
3. 在右侧商品列表中选择商品，点击"添加到合同"按钮
4. 在合同商品列表中可以：
   - 调整商品数量
   - 修改商品单价（如有特殊定价）
   - 删除不需要的商品
5. 设置合同信息：
   - 合同编号（默认格式：SC-YYYYMMDD-XXX）
   - 签订日期
   - 交货日期
   - 付款方式
   - 报价单有效期
6. 选择文档选项：
   - 生成合同
   - 生成报价单
   - 转换为PDF
   - 添加印章
   - 转换为图片式PDF（提高兼容性）
7. 点击"生成合同"按钮
8. 生成完成后，可以：
   - 点击"打开合同文件夹"查看生成的文件
   - 点击"打开合同文件"直接打开生成的PDF文件

### Excel转PDF工具

1. 切换到"Excel转PDF"标签页
2. 将Excel文件拖放到虚线框内，或点击"选择文件"按钮
3. 选择转换选项：
   - 转换为图片式PDF（提高兼容性）
4. 系统自动开始转换，显示进度条
5. 转换完成后，可以：
   - 点击"打开PDF"按钮查看生成的文件
   - 点击"打开文件夹"查看文件所在目录
   - 点击"重新选择"清除当前选择，转换新文件

### 公司信息管理

1. 在"系统"菜单中选择"配置公司信息"
2. 在弹出的对话框中可以：
   - 查看现有公司列表
   - 点击"添加公司"按钮新增公司
   - 选中公司后点击"编辑"修改信息
   - 选中公司后点击"删除"移除公司
   - 选中公司后点击"设为默认"将其设为默认使用的公司
3. 添加/编辑公司时，可以：
   - 填写公司基本信息
   - 上传公司印章图片
   - 从文本解析导入公司信息（如开票信息）

## ⚙️ 配置说明

### 配置文件位置

程序的配置文件存储在以下位置：
- `config/company.json`: 公司信息配置
- `config/settings.ini`: 系统设置配置

### 配置文件详解

#### company.json
```json
{
  "companies": [
    {
      "id": "1",
      "name": "示例公司名称",
      "contact": "联系人",
      "phone": "13800138000",
      "address": "公司地址",
      "bank_name": "开户银行",
      "bank_account": "银行账号",
      "tax_id": "税号",
      "stamp_path": "resources/stamp.png",
      "is_default": true
    }
  ]
}
```

#### settings.ini
```ini
[General]
contract_template = templates/contract_template.xlsx
quote_template = templates/quote_template.xlsx
output_dir = output
data_dir = data

[UI]
theme = fusion
font_family = Microsoft YaHei, Arial
font_size = 10
```

## 📁 文件结构

```
contractG/
├── config/                # 配置文件目录
│   ├── company.json       # 公司信息配置
│   └── settings.ini       # 系统设置配置
├── data/                  # 数据文件目录
│   ├── customers.xlsx     # 客户数据
│   └── products.xlsx      # 商品数据
├── logs/                  # 日志文件目录
├── output/                # 输出文件目录（生成的合同和报价单）
├── resources/             # 资源文件目录
│   └── icon.ico           # 应用程序图标
├── src/                   # 源代码目录
├── templates/             # 模板文件目录
├── contractG.exe          # 程序可执行文件
├── README.md              # 说明文档
├── requirements.txt       # 依赖包列表
└── 启动合同生成工具.bat      # 启动脚本
```

## 🆘 技术支持

如果您在使用过程中遇到任何问题，请通过以下方式获取支持：

- **问题反馈**: 提交Issue到项目仓库
- **功能建议**: 欢迎提交新功能建议或改进意见
- **联系开发者**: 通过电子邮件联系技术支持团队

</details>

